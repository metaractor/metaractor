services:
  metaractor:
    build: .
    image: outstand/metaractor:dev
    stdin_open: true
    tty: true
    environment:
      FIXUID:
      FIXGID:
      BUILDKITE:
      BUILDKITE_BUILD_URL:
      BUILDKITE_JOB_ID:
      BUILDKITE_AGENT_ACCESS_TOKEN:
    volumes:
      - bundler-data:/usr/local/bundle
      - .:/metaractor

  release:
    image: outstand/metaractor:dev
    stdin_open: true
    tty: true
    command: rake release
    environment:
      FIXUID:
      FIXGID:
    volumes:
      - bundler-data:/usr/local/bundle
      - ~/.gitconfig:/home/metaractor/.gitconfig
      - ~/.gitconfig.user:/home/metaractor/.gitconfig.user
      - ~/.config/gh/hosts.yml:/home/metaractor/.config/gh/hosts.yml
      - ~/.local/share/gem/credentials:/home/metaractor/.local/share/gem/credentials
      - ~/.local/share/gem/credentials:/home/metaractor/.gem/credentials

volumes:
  bundler-data:
